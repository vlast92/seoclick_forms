{"version":3,"sources":["../../sources/js/seoclick_forms.js"],"names":["renderInvisibleRecaptcha","jQuery","$","each","index","captcha","widgetId","grecaptcha","render","data","document","ready","inputs","sitePattern","phonePattern","emailPattern","forms","default_site_tooltip_text","default_email_tooltip_text","default_phone_tooltip_text","form","find","setEvents","on","validateForm","checkInputPatterns","input","def_pattern","def_tooltip_text","pattern","attr","tooltip","response","undefined","command","container","closest","after","next","hide","show","css","top","getBoundingClientRect","bottom","left","animate","opacity","input_obj","data_type","validation","checkPasteText","checkPressedKey","check","checkPattern","val","removeClass","event","originalEvent","clipboardData","getData","getPattern","test","preventDefault","e","ctrlKey","altKey","metaKey","chr","getChar","code","which","keyCode","String","fromCharCode","charCode","inputData","value","RegExp","addClass","checkFiles","files","responce","message","valid","file","file_size","size","max_size","name","Math","round","formData","FormData","formParams","window","formContainer","messageBox","files_data","captchaWidgetID","Number","recaptchaEnabled","getResponse","recaptchaType","execute","html","i","length","append","serializeArray","key","hasClass","scrollTop","offset","sendData","ajax","type","processData","contentType","success","respond","error","jqXHR","textStatus","complete","reset"],"mappings":"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","file":"seoclick_forms.js","sourcesContent":["//TODO сделать рендером всех рекапч вместо стандартного из Joomla\r\n//Рендер невидимых рекапч\r\nlet renderInvisibleRecaptcha = function () {\r\n    jQuery(function ($) {\r\n        $.each($('.g-recaptcha'), function (index, captcha) {\r\n            var widgetId = grecaptcha.render(captcha);\r\n\r\n            $(captcha).data('recaptcha-widget-id', widgetId);\r\n        });\r\n    });\r\n};\r\n\r\njQuery(document).ready(function ($) {\r\n\r\n    let inputs,\r\n        sitePattern = \"^[\\\\w \\\\.]+[\\\\.]{1}[\\\\D]{2,4}$\",\r\n        phonePattern = \"^[\\\\d \\\\+]{1,5}[\\\\( \\\\d \\\\) \\\\s]{1,10}[-?\\\\d \\\\s]{5}$\",\r\n        emailPattern = \"^[\\\\w \\\\.]+[@]{1}[\\\\w]+[\\\\.]{1}[\\\\D]{2,4}$\",\r\n        forms = $(\".form-validate\"),\r\n        default_site_tooltip_text = \"Адрес должен быть в формате site.domain\",\r\n        default_email_tooltip_text = \"Email должен быть в формате mailbox@mail.domain\",\r\n        default_phone_tooltip_text = \"Телефон должен быть в формате +код страны(код оператора)номер телефона. Например +375(33)123-45-67\";\r\n\r\n    $.each(forms, function (index, form) {\r\n\r\n        //получаем валиируемые поля формы\r\n        inputs = $(form).find(\".validate\");\r\n\r\n        //вызываем функцию установки обработчиков на поля формы\r\n        setEvents(inputs);\r\n        //вешам обработчик отправки формы\r\n        $(form).on(\"submit\", validateForm);\r\n    });\r\n\r\n    /*\r\n    * Функция проверяет атрибуты pattern и data-tooltip\r\n    * и в случае их отсутсвия присваивает им значения\r\n    * по умолчанию при их наличии и возвращает true\r\n    * иначе false\r\n    * */\r\n    function checkInputPatterns(input, def_pattern, def_tooltip_text) {\r\n\r\n        let pattern = input.attr(\"pattern\"),\r\n            tooltip = input.data(\"tooltip\"),\r\n            response = {pattern: false, tooltip: false};\r\n\r\n        if (pattern === undefined) {\r\n            if (def_pattern !== undefined) {\r\n                input.attr(\"pattern\", def_pattern);\r\n                response.pattern = true;\r\n            } else {\r\n                response.pattern = false;\r\n            }\r\n        } else {\r\n            response.pattern = true;\r\n        }\r\n\r\n        if (tooltip === undefined) {\r\n            if (def_tooltip_text !== undefined) {\r\n                input.data(\"tooltip\", def_tooltip_text);\r\n                response.tooltip = true;\r\n            } else {\r\n                response.tooltip = false;\r\n            }\r\n        } else {\r\n            response.tooltip = true;\r\n        }\r\n\r\n        return response;\r\n    }\r\n\r\n    /*\r\n    * Функция управления подсказками\r\n    * */\r\n    function tooltip(input, command) {\r\n\r\n        let container = input.closest('.form-validate');\r\n\r\n        switch (command) {\r\n            case 'create':\r\n                input.after(\"<div class='invalid-tooltip'><div>\" + input.data(\"tooltip\") + \"</div></div>\");\r\n                input.next().hide();\r\n                break;\r\n            case 'show':\r\n                input.next().show();\r\n                input.next().css({\r\n                    top: input[0].getBoundingClientRect().bottom - container[0].getBoundingClientRect().top + 8,\r\n                    left: input[0].getBoundingClientRect().left - container[0].getBoundingClientRect().left\r\n                });\r\n                input.next().animate({\r\n                    opacity: 1\r\n                }, 300, () => {\r\n                    input.next().show();\r\n                });\r\n                break;\r\n            case 'hide':\r\n                input.next().animate({\r\n                    opacity: 0\r\n                }, 300, () => {\r\n                    input.next().hide();\r\n                });\r\n                break;\r\n        }\r\n    }\r\n\r\n    //функция установки обработчиков полей формы\r\n    function setEvents(inputs) {\r\n\r\n        $.each(inputs, function (index, input) {\r\n\r\n            let input_obj = $(input),\r\n                data_type = input_obj.attr(\"data-validate\"),\r\n                validation;\r\n\r\n            //устанавливвваем шаблоны для полей формы\r\n            switch (data_type) {\r\n                case \"site\":\r\n                    validation = checkInputPatterns(input_obj, sitePattern, default_site_tooltip_text);\r\n                    break;\r\n                case \"email\":\r\n                    validation = checkInputPatterns(input_obj, emailPattern, default_email_tooltip_text);\r\n                    break;\r\n                case \"phone\":\r\n                    validation = checkInputPatterns(input_obj, phonePattern, default_phone_tooltip_text);\r\n                    input_obj.on(\"paste\", checkPasteText);\r\n                    input_obj.on(\"keypress\", checkPressedKey);\r\n                    break;\r\n                default:\r\n                    validation = checkInputPatterns(input_obj);\r\n                    if (!validation.tooltip && !validation.pattern) return true;\r\n            }\r\n            if (validation.tooltip) {\r\n                tooltip(input_obj, 'create');\r\n                input_obj.on(\"mouseenter\", function () {\r\n                    tooltip(input_obj, 'show');\r\n                });\r\n                input_obj.on(\"focusout mouseleave\", function () {\r\n\r\n                    tooltip(input_obj, 'hide');\r\n                });\r\n            }\r\n            //устанавливаем обработчик на проверку вводимых данных\r\n            if (validation.pattern) {\r\n                input_obj.on(\"change keyup\", function () {\r\n\r\n                    let check = checkPattern($(this));\r\n\r\n                    if (validation.tooltip) {\r\n                        if (!check) {\r\n                            tooltip(input_obj, 'show');\r\n                        } else {\r\n                            tooltip(input_obj, 'hide');\r\n                        }\r\n                    }\r\n                });\r\n                input_obj.on(\"focusout mouseleave\", function () {\r\n\r\n                    if (input_obj.val() === '') {\r\n                        input_obj.removeClass('invalid');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    //функция проверки вставленные данные в поле формы по шаблону\r\n    function checkPasteText(event) {\r\n        let pattern,\r\n            data = event.originalEvent.clipboardData.getData('text/plain');\r\n\r\n        pattern = getPattern($(this));\r\n\r\n        //проверка данных по шаблону\r\n        if (!pattern.test(data)) {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    /*\r\n    * функция проверки нажатой клавиши\r\n    * Функция возвращет false на все клавиши,\r\n    * кроме цифр, знаков + - ( ) и пробелов\r\n    */\r\n    function checkPressedKey(event) {\r\n\r\n        let e = event;\r\n\r\n        if (e.ctrlKey || e.altKey || e.metaKey) {\r\n            return;\r\n        }\r\n\r\n        let chr = getChar(e);\r\n\r\n        // с null надо осторожно в неравенствах, т.к. например null >= '0' => true!\r\n        // на всякий случай лучше вынести проверку chr = null отдельно\r\n        if (chr === null) {\r\n            return;\r\n        }\r\n\r\n        if (chr < '0' || chr > '9') {\r\n            if (chr !== \"+\" && chr !== \"-\" && chr !== \"(\" && chr !== \")\" && chr !== \" \") {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    //функция возвращает код символа\r\n    function getChar(event) {\r\n\r\n        if (event.code === \"Space\" || event.code === \"Equal\" || event.code === \"Digit9\" || event.code === \"Digit0\") {\r\n            return 0;\r\n        }\r\n        if (event.which === null) { // IE\r\n            if (event.keyCode < 32) return null; // спец. символ\r\n            return String.fromCharCode(event.keyCode)\r\n        }\r\n\r\n        if (event.which !== 0 && event.charCode !== 0) { // все кроме IE\r\n            if (event.which < 32) return null; // спец. символ\r\n            return String.fromCharCode(event.which); // остальные\r\n        }\r\n\r\n        return null; // спец. символ\r\n    }\r\n\r\n    /*\r\n    * Функция проверки введенных данных по шаблону\r\n    * возвращает false если проверка не пройдена\r\n    */\r\n    function checkPattern(inputData) {\r\n\r\n        let value = inputData.val(), pattern;\r\n\r\n        pattern = new RegExp(inputData.attr(\"pattern\"));\r\n\r\n        //проверка данных по шаблону\r\n        if (!pattern.test(value)) {\r\n            inputData.addClass(\"invalid\");\r\n            return false;\r\n        } else {\r\n            inputData.removeClass(\"invalid\");\r\n            return true;\r\n        }\r\n    }\r\n\r\n    //Валидация вложений формы\r\n    function checkFiles(files, form) {\r\n\r\n\r\n        let responce = {message: \"\", valid: true};\r\n\r\n        $.each(files, function (index, file) {\r\n\r\n            let file_size = file.size / 1000, max_size = form.find(\".file-input\").data(\"size\");\r\n\r\n            if (file_size > max_size) {\r\n\r\n                responce.message = \"Размер файла \" + file.name + \" превышает допустимый размер в \" + max_size + \" кб. Его размер \" +\r\n\r\n                    Math.round(file_size) + \" кб.\";\r\n                responce.valid = false;\r\n\r\n                return responce;\r\n            }\r\n        });\r\n\r\n        return responce;\r\n    }\r\n\r\n    //Валидация формы\r\n    function validateForm(event) {\r\n\r\n        event.preventDefault();\r\n\r\n        let data,\r\n            formData = new FormData(),\r\n            form = $(this),\r\n            formParams = window[\"seoclickForm_\" + form.data(\"moduleid\")],\r\n            formContainer = form.closest(\".seoclick-forms\"),\r\n            messageBox = formContainer.find(\".message-container\"),\r\n            files_data = form.find('.file-input')[0];\r\n\r\n        formParams.captchaWidgetID = form.find(\".g-recaptcha\").data(\"recaptcha-widget-id\");\r\n        if (Number(formParams.recaptchaEnabled) && grecaptcha.getResponse(formParams.captchaWidgetID) === \"\") {\r\n            if (formParams.recaptchaType === 'invisible') {\r\n                grecaptcha.execute(formParams.captchaWidgetID);\r\n\r\n                return false;\r\n            }\r\n            messageBox.addClass(\"active\");\r\n            messageBox.html(\"Не пройдена проверка 'Я не робот'\");\r\n            return false;\r\n        }\r\n\r\n        messageBox.addClass(\"active\");\r\n\r\n        if (files_data !== undefined) {\r\n            files_data = files_data.files;\r\n\r\n            let check = checkFiles(files_data, form);\r\n\r\n            if (!check.valid) {\r\n                messageBox.html(check.message);\r\n                return 0;\r\n            }\r\n            for (let i = 0; i < files_data.length; i++) {\r\n                formData.append(\"file_\" + i, files_data[i]);\r\n            }\r\n        }\r\n\r\n        data = form.serializeArray();\r\n        $.each(data, function (key, input) {\r\n            formData.append(input.name, input.value);\r\n        });\r\n\r\n        //Добавляем параметры запроса\r\n        formData.append('option', 'com_ajax');\r\n        formData.append('module', 'seoclick_forms');\r\n        formData.append('format', 'json');\r\n\r\n        //Прокрутка окна браузера до окна сообщений формы\r\n        if ($(formContainer).hasClass(\"seoclick-forms-popup-wrap\")) {\r\n            $(formContainer).find(\".container\").animate({\r\n                scrollTop: 0\r\n            }, 300);\r\n        } else {\r\n            $('html, body').animate({\r\n                scrollTop: formContainer.offset().top - 200\r\n            }, 300);\r\n        }\r\n\r\n        sendData(formData, formParams, messageBox);\r\n    }\r\n\r\n    //функция отправки данных на сервер\r\n    function sendData(formData, formParams, messageBox) {\r\n\r\n        messageBox.html(\"Отправка...\");\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            data: formData,\r\n            processData: false,\r\n            contentType: false,\r\n\r\n            success: function (respond) {\r\n\r\n                if (respond.message !== null) {\r\n                    messageBox.html(respond.message);\r\n                } else {\r\n                    messageBox.html(respond.data);\r\n                }\r\n            },\r\n            error: function (jqXHR, textStatus) {\r\n                messageBox.html('Ошибка AJAX запроса: ' + textStatus);\r\n            },\r\n            complete: function () {\r\n                if (Number(formParams.recaptchaEnabled)) grecaptcha.reset(formParams.captchaWidgetID);\r\n            }\r\n        });\r\n    }\r\n});"]}